function [ud] = rungekutta(h, a, b, u, r)
% Solves for y and y' using RK4 method
N = (b-a)/h;
p = @(x) (2*x/(1+x^2));
q = @(x) (-2/(1+x^2));

k = zeros(4,2);
ud = [];

for i = 1:N
    x = a + i*h;
    ud = [ud; x, u(1),u(2)];

    k(1,1) = h*u(2);
    k(1,2) = h*(p(x)*u(2) + q(x)*u(1) + r);
    k(2,1) = h*(u(2) + 0.5*k(1,2));
    k(2,2) = h*(p(x+(h/2))*(u(2)+0.5*k(1,2)) + q(x+h/2)*(u(1) + 0.5*k(1,1)) + r);
    k(3,1) = h*(u(2) + 0.5*k(2, 2));
    k(3,2) = h*(p(x+h/2)*(u(2) + 0.5*k(2,2)) + q(x+h/2)*(u(1) + 0.5*k(2,1)) + r);
    k(4,1) = h*(u(2) + k(3,2));
    k(4,2) = h*(p(x+h)*(u(2) + k(3,2)) + q(x+h)*(u(1) + k(3,1)) + r);

    u(1) = u(1) + (1/6)*(k(1,1) + 2*(k(2,1) + k(3,1)) + k(4,1));
    u(2) = u(2) + (1/6)*(k(1,2) + 2*(k(2,2) + k(3,2)) + k(4,2));
    
end
end